{% extends 'main.html' %}

{% load static %}

{% block title %}Events{% endblock %}

{% block content %}
  <div class="list-of-events">List of events:</div>
  <div class="events-list">
    {% for event in events %}
      <ul>
        <li>
            <b><a href="{% url 'event' event.id %}">{{ event.name }}</a></b> <br>

            {% if event.host %}
                Host: <b>{{ event.host }}</b> <br>
            {% endif %}

            Location: {{ event.location }}<br>

            {% if event.file %}
            <div class="create_event-file">
              <a href="{{ event.file }}" target="_blank"><img src="{{ event.file }}" width="50px"></a>
            </div>
            {% endif %}

            <div class="event_date">
              Start of event: <b>{{ event.start_event }}</b> <br>
              End of event: <b>{{ event.end_event }}</b> <br>
            </div>

            {{ event.description|slice:"0:50" }} <br>

            {% if event.comments_count > 0 %}
              ({{ event.comments_count }} comments, last comment date: {{ event.last_comment_time }})
            {% else %}
              (no comment yet)
            {% endif %} <br>

            {% if request.user not in event.participants.all %}
              <a href="{% url 'join_event' event.id request.user.id %}">Join</a>
            {% endif %}
            {% if request.user in event.participants.all %}
              <a href="{% url 'unjoin_event' event.id request.user.id %}">Unjoin</a>
            {% endif %}

            {% if event.host.id == request.user.id or admin %}  <!-- Pokud je pÅ™ihlÃ¡Å¡enÃ½ uÅ¾ivatel "majitel" mÃ­stnosti -->
            <a href="{% url 'edit_event' event.id %}">Edit ðŸ–‰</a>
              <a href="{% url 'delete_event' event.id %}">Delete
                <img src="{% static 'event/cross.png' %}" alt='delete' width="12px"></a>
            {% endif %}
        </li>
      </ul>
    {% endfor %}
  </div>
{% endblock %}
